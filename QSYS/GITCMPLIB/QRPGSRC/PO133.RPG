     F*----------------------------------------------------------------
     F*   Copyright (C) 1999 BFC Software, Inc. - All Rights Reserved
     F*   BFC Software, Inc.
     F*   799 Roosevelt Rd.  Bldg 6, Suite 108
     F*   Glen Ellyn, IL  60137
     F*   (630) 790-8383
     F*----------------------------------------------------------------
     F*
     F*  PO133     Item Receiving Log - View
     F*  07 October 1999
     F*  Max Blacknik
     F*
     F*  Revisions
     F*    01/20/00  MLB  4.13a
     F*      - Recompile, PIRTRCK1 changed.
     F*
     F*----------------------------------------------------------------
     F*  Indicator usage
     F*
     F*  01 - 20   Field position to
     F*  21 - 40   Field input error (reverse display)
     F*  46        Condition output - No activity zones found.
     F*  47        Condition output - No build codes found.
     F*  90        View mode (Protect input fields)
     F*  91        Change mode (protect key)
     F*  97        Error message subfile indicator
     F*  98        Error on screen (sound buzzer)
     F*  99        Universal record indicator (very temporary usage)
     F*
     F*----------------------------------------------------------------
     F*  File Specs
     F*
     FPO133FM CF  E                    WORKSTN
     F                                              KINFDS INFDS
     F                                        RECNO KSFILE DSPSFL6
     F                                        RECNO KSFILE DSPSFL7
     FPIRTRCK1IF  E           K        DISK
     FACTIVITYIF  E           K        DISK
     FBLDCODE IF  E           K        DISK
     FDESIG   IF  E           K        DISK
     FPIRITEM IF  E           K        DISK
     FPOHDR   IF  E           K        DISK
     FUNMESR  IF  E           K        DISK
     FWAREHS  IF  E           K        DISK
     FWHDEPT  IF  E           K        DISK
     E*----------------------------------------------------------------
     E*  Table and array definitions
     E*
     E                    A10        10  1
     E                    $MD       128  1
     E                    OCR         9 10
     E                    TRR        25  6               Tracking subr
     E                    SRCD       11  6               Subfile rcd
     E                    CMDLN   1   5 79
     I*----------------------------------------------------------------
     I*  Program parameters
     I*
     I$PARMS      DS
     I                                        9  18 $PPRG
     I                                       19  68 $PUKY
     I                                       69  76 $PRTN
     I                                       77 136 $PERM
     I                                       77  80 $PMSG
     I*
     I*   Redefine key
     I*
     I*----------------------------------------------------------------
     I*  Calling program parameters
     I*
     I$LPARM      DS
     I                                        1  50 $LEN50
     I                                        1   30$LWHSE
     I                                        4  12 $LPO
     I                                       13  27 $LITEM
     I                                       28  350$LRCDT
     I                                       36  410$LRCTM
     I*----------------------------------------------------------------
     I*
     I* The following data structures are for capturing receiving
     I* tracking info.
     I*
     I*----------------------------------------------------------------
     I*  *RCV001   -  Received Item Header info
     I*----------------------------------------------------------------
     I*
     I* Fields
     I*
     I*    TRRQY1  -  Qty received 1
     I*    TRRQY2  -  Qty received 2
     I*    TRRQY3  -  Qty received 3
     I*    TREXPD  -  Expiration date for item
     I*    TRSTYP  -  Section type
     I*    TRWHDP  -  Warehouse department
     I*    TRDESG  -  Item designation
     I*    TRTYPE  -  Item type
     I*    TRBLD   -  Item build code
     I*    TRACTV  -  Item activity zone
     I*    TRPCMD  -  Program processing option
     I*    TRPPRG  -  Calling program
     I*    TRVEN#  -  Vendor number
     I*
     I* Data structure
     I*
     ITR01DS      DS
     I                                        1   50TRRCQ1
     I                                        6   7 TRUOM1
     I                                        8  120TRRCQ2
     I                                       13  14 TRUOM2
     I                                       15  190TRRCQ3
     I                                       20  21 TRUOM3
     I                                       22  290TREXPD
     I                                       30  30 TRSTYP
     I                                       31  35 TRWHDP
     I                                       36  40 TRDESG
     I                                       41  41 TRTYPE
     I                                       42  43 TRBLD
     I                                       44  45 TRACTV
     I                                       46  480TRNRPK
     I                                       49  56 TRPCMD
     I                                       57  66 TRPPRG
     I                                       67  770TRVEN#
     I                                       78  840TRSEQ
     I                                       85  85 TRDSCD
     I                                        1 150 TRDT01
     I*----------------------------------------------------------------
     I*  *RCV002  -  System options
     I*----------------------------------------------------------------
     I*
     I* Fields
     I*
     I*    TREPM   -  Using EPM module (Y,N).
     I*    TRRF    -  Using RF module (Y,N).
     I*    TRCAPC  -  Capture catch weights at pick closing (Y,N).
     I*    TRLETD  -  Print letdown labels (Y,N).
     I*    TRWRNC  -  Perform catch weight variance check (Y,N).
     I*    TRRG1C  -  Catch weight low variance percentage.
     I*    TRRG2C  -  Catch weight high variance percentage.
     I*    TRIMPI  -  Import item fields from host.(Y,N).
     I*    TRICW   -  Individual catch weight entry (Y,N).
     I*    TRMPCK  -  Allow multiple pick slots for fixed items (Y,N).
     I*    TRRCDY  -  Number of days to keep receiving logs.
     I*    TRMPCK  -  Number of days to keep picking logs.
     I*
     I* Data structure
     I*
     ITR02DS      DS
     I                                        1   1 TREPM
     I                                        2   2 TRRF
     I                                        3   3 TRCAPC
     I                                        4   4 TRLETD
     I                                        5   5 TRWRNC
     I                                        6   81TRRG1C
     I                                        9  111TRRG2C
     I                                       12  12 TRIMPI
     I                                       13  13 TRICW
     I                                       14  14 TRMPCK
     I                                       15  150TRRCDY
     I                                       16  160TRPKDY
     I*----------------------------------------------------------------
     I*  *RCV003  -  Receiving options
     I*----------------------------------------------------------------
     I*
     I* Fields
     I*
     I*    TRLPGM  -  Receiving label program.
     I*    TRUPCT  -  Ideal slot usage percentage.
     I*    TRPDEF  -  PIR minimum number of slots priority.
     I*    TRPBLD  -  PIR same build code priority.
     I*    TRPACT  -  PIR same activity zone priority.
     I*    TRFDEF  -  Fixed minimum number or slots priority.
     I*    TRFASL  -  Fixed same aisle priority.
     I*    TRFSID  -  Fixed same side priority.
     I*    TRFLVL  -  Fixed highest level priority.
     I*    TRPASL  -  PIR same aisle priority.
     I*    TRPFRC  -  Force PIR same aisle priority.
     I*    TRPLCN  -  Use generic license plates.
     I*    TRPCHM  -  Check chimney (Y,N)
     I*    TRPMIX  -  Allow mixed expiration dates in fixed home slot(Y,N)
     I*    TRAPCK  -  Assign pick slots automatically for fixed items(Y,N)
     I*
     I* Data structure
     I*
     ITR03DS      DS
     I                                        1  10 TRLPGM
     I                                       11  130TRUPCT
     I                                       14  140TRPDEF
     I                                       15  150TRPBLD
     I                                       16  160TRPACT
     I                                       17  170TRFDEF
     I                                       18  180TRFASL
     I                                       19  190TRFSID
     I                                       20  200TRFLVL
     I                                       21  210TRPASL
     I                                       22  22 TRPFRC
     I                                       23  23 TRPLCN
     I                                       24  24 TRPCHM
     I                                       25  25 TRPMIX
     I                                       26  26 TRAPCK
     I*----------------------------------------------------------------
     I*  *RCV010  -  Item definitions
     I*----------------------------------------------------------------
     I*
     I* Fields
     I*
     I*   TRSDEF - Slot definition.
     I*   TRTIE  - Tie value.
     I*   TRHIGH - High value.
     I*   TRPQTY - Quantity on one pallet (Tie * High).
     I*   TRPOS  - Number of pallet positions in slot.
     I*   TRPOSF - Number of full pallet positions in slot.
     I*   TRPLTS - Total number of pallets needed.
     I*   TRSLTS - Total number of slots needed.
     I*   TRSQTY - Quantity to fill one slot.
     I*   TRPCTU - Percent of slot used.
     I*   TRTQTY - Total quantity that can fit in slot (DSPQTY * DSPOS)
     I*
     I* Data structure
     I*
     ITR10DS      DS
     I                                        1   2 TRSDEF
     I                                        3   60TRTIE
     I                                        7   80TRHIGH
     I                                        9  130TRPQTY
     I                                       14  161TRPOS
     I                                       17  180TRPOSF
     I                                       19  210TRPLTS
     I                                       22  240TRSLTS
     I                                       25  290TRSQTY
     I                                       30  345TRPCTU
     I                                       35  410TRTQTY
     I                                        1 150 TRDT10
     IDEFS        DS                          9
     I                                        1   2 DSSDEF
     I                                        3   60DSTIE
     I                                        7   80DSHIGH
     I                                        9  130DSPQTY
     I                                       14  161DSPOS
     I                                       17  180DSPOSF
     I                                       19  210DSPLTS
     I                                       22  240DSSLTS
     I                                       25  290DSSQTY
     I                                       30  345DSPCTU
     I                                       35  410DSTQTY
     I*----------------------------------------------------------------
     I*  *RCV011  -  Item occurances array
     I*----------------------------------------------------------------
     I*
     I* Fields
     I*
     I*    TROCR   -  See array OCR. 9 element array, 10 char length.
     I*    TRLDEF  -  Number of occurances in array OCR.
     I*
     I* Data structure
     I*
     ITR11DS      DS
     I                                        1  90 OCR
     I                                        1  90 TROCUR
     I                                      149 1500TRLDEF
     I                                        1 150 TRDT11
     ISAVDS       DS
     I                                        1  10 SVGRP
     I                                        1   1 SVFLAG
     I                                        2   40SVSLTS
     I                                        5   95SVPCTE
     I                                       10  100SVOCUR
     I*----------------------------------------------------------------
     I*  *RCV020  -  Activity zones
     I*----------------------------------------------------------------
     I*
     I* Fields
     I*
     I*    TRAZxx  -  Activity zone 01 - 50
     I*
     I* Data structure
     I*
     ITR20DS      DS
     I                                        1   2 TRAZ01
     I                                        3   4 TRAZ02
     I                                        5   6 TRAZ03
     I                                        7   8 TRAZ04
     I                                        9  10 TRAZ05
     I                                       11  12 TRAZ06
     I                                       13  14 TRAZ07
     I                                       15  16 TRAZ08
     I                                       17  18 TRAZ09
     I                                       19  20 TRAZ10
     I                                       21  22 TRAZ11
     I                                       23  24 TRAZ12
     I                                       25  26 TRAZ13
     I                                       27  28 TRAZ14
     I                                       29  30 TRAZ15
     I                                       31  32 TRAZ16
     I                                       33  34 TRAZ17
     I                                       35  36 TRAZ18
     I                                       37  38 TRAZ19
     I                                       39  40 TRAZ20
     I                                       41  42 TRAZ21
     I                                       43  44 TRAZ22
     I                                       45  46 TRAZ23
     I                                       47  48 TRAZ24
     I                                       49  50 TRAZ25
     I                                       51  52 TRAZ26
     I                                       53  54 TRAZ27
     I                                       55  56 TRAZ28
     I                                       57  58 TRAZ29
     I                                       59  60 TRAZ30
     I                                       60  62 TRAZ31
     I                                       63  64 TRAZ32
     I                                       65  66 TRAZ33
     I                                       67  68 TRAZ34
     I                                       69  70 TRAZ35
     I                                       71  72 TRAZ36
     I                                       73  74 TRAZ37
     I                                       75  76 TRAZ38
     I                                       77  78 TRAZ39
     I                                       79  80 TRAZ40
     I                                       81  82 TRAZ41
     I                                       83  84 TRAZ42
     I                                       85  86 TRAZ43
     I                                       87  88 TRAZ44
     I                                       89  90 TRAZ45
     I                                       91  92 TRAZ46
     I                                       93  94 TRAZ47
     I                                       95  96 TRAZ48
     I                                       97  98 TRAZ49
     I                                       99 100 TRAZ50
     I                                        1 150 TRDT20
     I*----------------------------------------------------------------
     I*  *RCV030  -  Build codes
     I*----------------------------------------------------------------
     I*
     I* Fields
     I*
     I*    TRBCxx  -  Build code 01 - 50
     I*
     I* Data structure
     I*
     ITR30DS      DS
     I                                        1   2 TRBC01
     I                                        3   4 TRBC02
     I                                        5   6 TRBC03
     I                                        7   8 TRBC04
     I                                        9  10 TRBC05
     I                                       11  12 TRBC06
     I                                       13  14 TRBC07
     I                                       15  16 TRBC08
     I                                       17  18 TRBC09
     I                                       19  20 TRBC10
     I                                       21  22 TRBC11
     I                                       23  24 TRBC12
     I                                       25  26 TRBC13
     I                                       27  28 TRBC14
     I                                       29  30 TRBC15
     I                                       31  32 TRBC16
     I                                       33  34 TRBC17
     I                                       35  36 TRBC18
     I                                       37  38 TRBC19
     I                                       39  40 TRBC20
     I                                       41  42 TRBC21
     I                                       43  44 TRBC22
     I                                       45  46 TRBC23
     I                                       47  48 TRBC24
     I                                       49  50 TRBC25
     I                                       51  52 TRBC26
     I                                       53  54 TRBC27
     I                                       55  56 TRBC28
     I                                       57  58 TRBC29
     I                                       59  60 TRBC30
     I                                       60  62 TRBC31
     I                                       63  64 TRBC32
     I                                       65  66 TRBC33
     I                                       67  68 TRBC34
     I                                       69  70 TRBC35
     I                                       71  72 TRBC36
     I                                       73  74 TRBC37
     I                                       75  76 TRBC38
     I                                       77  78 TRBC39
     I                                       79  80 TRBC40
     I                                       81  82 TRBC41
     I                                       83  84 TRBC42
     I                                       85  86 TRBC43
     I                                       87  88 TRBC44
     I                                       89  90 TRBC45
     I                                       91  92 TRBC46
     I                                       93  94 TRBC47
     I                                       95  96 TRBC48
     I                                       97  98 TRBC49
     I                                       99 100 TRBC50
     I                                        1 150 TRDT30
     I*----------------------------------------------------------------
     I*  *RCV040  -  Subroutines entered
     I*----------------------------------------------------------------
     I*
     I* Fields
     I*
     I*    TRSUBR - Subroutines entered - 25 element array,6 char length.
     I*
     I* Data structure
     I*
     ITR40DS      DS
     I                                        1   6 TRSR01
     I                                        7  12 TRSR02
     I                                       13  18 TRSR03
     I                                       19  24 TRSR04
     I                                       25  30 TRSR05
     I                                       31  36 TRSR06
     I                                       37  42 TRSR07
     I                                       43  48 TRSR08
     I                                       49  54 TRSR09
     I                                       55  60 TRSR10
     I                                       61  66 TRSR11
     I                                       67  72 TRSR12
     I                                       73  78 TRSR13
     I                                       79  84 TRSR14
     I                                       85  90 TRSR15
     I                                       91  96 TRSR16
     I                                       97 102 TRSR17
     I                                      103 108 TRSR18
     I                                      109 114 TRSR19
     I                                      115 120 TRSR20
     I                                      121 126 TRSR21
     I                                      127 132 TRSR22
     I                                      133 138 TRSR23
     I                                      139 144 TRSR24
     I                                      145 150 TRSR25
     I                                        1 150 TRR
     I                                        1 150 TRDT40
     ISFLDS       DS
     I                                        1   6 W6SR01
     I                                        7  12 W6SR02
     I                                       13  18 W6SR03
     I                                       19  24 W6SR04
     I                                       25  30 W6SR05
     I                                       31  36 W6SR06
     I                                       37  42 W6SR07
     I                                       43  48 W6SR08
     I                                       49  54 W6SR09
     I                                       55  60 W6SR10
     I                                       61  66 W6SR11
     I                                        1  66 SRCD
     I*----------------------------------------------------------------
     I*  Tracking messages
     I*----------------------------------------------------------------
     I              '*NOTFOUND'           C         TRERR
     I*----------------------------------------------------------------
     I*  Called programs
     I*
     I              'CVTDTE'              C         @CVTDT
     I              'FRMTIT'              C         @FMTIT
     I*----------------------------------------------------------------
     I*  Called program parameters
     I*
     I$CVTDT      DS
     I                                        1   8 $CVCMD
     I                                        9  18 $CVPRG
     I                                       19  24 $CVD6I
     I                                       25  32 $CVD8I
     I                                       33  380$CVD6O
     I                                       39  460$CVD8O
     I                                       47  64 $CVSTO
     I                                       65  72 $CVRTN
     I                                       73 132 $CVERM
     I                                       73  76 $CVMSG
     I*
     I*----------------------------------------------------------------
     I*  Data structure for error message parameters
     I*
     I$MDT        DS
     I                                        1  50 ERRMSG
     I*
     I                                    P   1   20ERWHSE
     I*
     I                                        1  30 ERFLD
     I                                       31  40 ERFROM
     I                                       41  50 ERTO
     I*
     I                                        1  15 ERITM
     I                                    P  16  190ERCO#
     I*
     I                                       16  27 ERDISP
     I*
     I                                    P   1   20ERMDAY
     I                                    P   3   60ERMFDT
     I                                    P   7  100EREXDT
     I                                    P  11  140ERLTST
     I                                    P  15  160ERDDAY
     I                                    P  17  180ERUDAY
     I            DS
     I                                    P   1   20$EC
     I*----------------------------------------------------------------
     I* Data structure
     I*
     IOPDATA      DS
     I                                        1   1 OPSTYP
     I                                        2   6 OPWHDP
     I                                        7   8 OPUM1
     I                                        9  23 OPDUM
     I                                       24  43 OPCUM
     I                                       44  522OPCDIV
     I                                       53  53 OPCAUT
     I                                       54  54 OPCWRN
     I                                       55  571OPCRNG
     I                                       58  72 OPWUM
     I                                       73  73 OPXDSC
     I                                      117 117 OPTEND
     I                                        1  10 OPLPGM
     I                                       11  130OPUPCT
     I                                       14  140OPPDEF
     I                                       15  150OPPBLD
     I                                       16  160OPPACT
     I                                       17  170OPFDEF
     I                                       18  180OPFASL
     I                                       19  190OPFSID
     I                                       20  200OPFLVL
     I                                       21  210OPPASL
     I                                       22  22 OPPFRC
     I                                       23  23 OPPLCN
     I*----------------------------------------------------------------
     I*  Message control
     I*
     I              'PIRMSGF   '          C         #MSGF
     I*
     I            DS
     I                                        1 128 #MSGDT
     I                                        1 128 $MD
     I*----------------------------------------------------------------
     I*  Program info data structure
     I*
     I           SDS
     I                                     *PROGRAM #PROG
     I                                      244 253 #JOB
     I                                      254 263 #USER
     I                                      264 269 #JOBN
     I                                      276 2810#JOBDT
     I                                      282 2870#JOBTM
     I*----------------------------------------------------------------
     I*  Workstation exception data structure
     I*
     IINFDS       DS
     I                                     *STATUS  STATUS
     I                                      370 370 ROWIN
     I                                      371 371 COLIN
     I*----------------------------------------------------------------
     I*  Workstation exception redefinition data structure
     I*
     I            DS
     I                                    B   1   20ROW#
     I                                        2   2 ROW
     I                                    B   3   40COL#
     I                                        4   4 COL
     I*----------------------------------------------------------------
     C*  Parameters
     C*
     C*    Input Parameters
     C*      $PCMD   *VIEW    - View receiving log - Most recent entry.
     C*              *VIEW2   - View receiving log - Specific entry.
     C*      $PPO    Purchase order number
     C*      $PITEM  Item number
     C*      $PRCDT  Receiving date
     C*      $PRCTM  Receiving time
     C*      $PDEV   Workstation
     C*      $PUSER  Received by
     C*
     C*    Returned Parameters
     C*      None
     C*
     C*----------------------------------------------------------------
     C*  Let the show begin .....
     C*
     C           *ENTRY    PLIST
     C                     PARM           $PCMD   8
     C                     PARM           $PWHSE  30
     C                     PARM           $PPO    9
     C                     PARM           $PITEM 15
     C                     PARM           $PRCDT  80
     C                     PARM           $PRCTM  60
     C                     PARM           $PDEV  10
     C                     PARM           $PUSER 10
     C*----------------------------------------------------------------
     C*  Main line
     C*
     C                     MOVE *ON       *IN97
     C                     MOVE *OFF      *IN90
     C                     MOVE *OFF      *IN91
     C                     MOVE *OFF      *IN92
     C                     MOVE *OFF      ERROR
     C                     MOVE *BLANKS   $PRTN
     C                     MOVE *BLANKS   $PERM
     C                     EXSR ZZINZ2
     C           ERROR     IFEQ *ON
     C                     MOVE 'EOJ'     NXTSCR
     C                     END
     C*
     C           NXTSCR    DOWNE'EOJ'
     C                     EXSR DSPSCR
     C           NXTSCR    CASEQ'01 '     SC1
     C           NXTSCR    CASEQ'02 '     SC2
     C           NXTSCR    CASEQ'03 '     SC3
     C           NXTSCR    CASEQ'04 '     SC4
     C           NXTSCR    CASEQ'05 '     SC5
     C           NXTSCR    CASEQ'06 '     SC6
     C           NXTSCR    CASEQ'07 '     SC7
     C                     ENDCS
     C                     ENDDO
     C*
     C*   Do some clean up before leaving.
     C*
     C                     EXSR ZSCLR
     C                     RETRN
     C*----------------------------------------------------------------
     C*  DSPSCR - Display screen
     C*
     CSR         DSPSCR    BEGSR
     C*
     C*   Set ON alarm indicator if error occured
     C*
     CSR         ERROR     IFEQ *ON
     CSR                   MOVE *ON       *IN98
     CSR                   END
     C*
     C*   Overlay screen with error messages
     C*
     C                     EXSR ZMDMSG
     C*
     C*  Overlay screen with screen to be processed.
     C*
     CSR         NXTSCR    IFEQ '01 '
     CSR                   WRITECMDREC
     CSR                   EXFMTSCREEN1                50
     CSR                   END
     C*
     CSR         NXTSCR    IFEQ '02 '
     CSR                   EXFMTSCREEN2                50
     CSR                   END
     C*
     CSR         NXTSCR    IFEQ '03 '
     CSR                   EXFMTSCREEN3                50
     CSR                   END
     C*
     CSR         NXTSCR    IFEQ '04 '
     CSR                   EXFMTSCREEN4                50
     CSR                   END
     C*
     CSR         NXTSCR    IFEQ '05 '
     CSR                   EXFMTSCREEN5                50
     CSR                   END
     C*
     CSR         NXTSCR    IFEQ '06 '
     CSR                   WRITECMDREC6                50
     CSR                   EXFMTDSPSFC6                50
     CSR                   END
     C*
     CSR         NXTSCR    IFEQ '07 '
     CSR         *IN56     IFEQ *ON
     CSR                   WRITECLRSCR
     CSR                   ENDIF
     CSR                   WRITECMDREC7                50
     CSR                   EXFMTDSPSFC7                50
     CSR                   END
     C*
     C*   Initialize error indicators and fields
     C*
     CSR                   SETOF                     010203
     CSR                   SETOF                     040506
     CSR                   SETOF                     070809
     CSR                   SETOF                     10
     CSR                   SETOF                     111213
     CSR                   SETOF                     212223
     CSR                   SETOF                     242526
     CSR                   SETOF                     272829
     CSR                   SETOF                     303132
     CSR                   SETOF                     33
     CSR                   SETOF                     616263
     CSR                   SETOF                     98
     CSR                   MOVE *OFF      ERROR   1
     CSR                   MOVE *OFF      CMDTKN  1
     CSR                   Z-ADD0         E       20
     C*
     C*   Initialize error subfile
     C*
     CSR                   EXSR ZMCPMQ
     C*
     CSR                   ENDSR
     C*----------------------------------------------------------------
     C*
     C*     Screen initialization and wrap-up routines
     C*
     C*----------------------------------------------------------------
     C*
     C*  Screen 01 initialization
     C*
     CSR         SCR01I    BEGSR
     CSR                   MOVE '01 '     NXTSCR  3
     C*
     C*  Get field defaults if this is an add.
     C*
     CSR         $PCMD     IFEQ '*ADD    '
     CSR                   EXSR ZZDFT1
     CSR                   ELSE
     C*
     C*  Otherwise get existing record(s).
     C*
     CSR                   MOVE *ON       *IN91
     CSR                   EXSR ZZGET1
     CSR                   EXSR ZZFIL1
     CSR                   END
     CSR         END01I    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  Screen 02 initialization
     C*
     CSR         SCR02I    BEGSR
     CSR                   MOVE '02 '     NXTSCR
     C*
     C*  Get field defaults if this is an add.
     C*
     CSR         $PCMD     IFEQ '*ADD    '
     CSR                   EXSR ZZGET2
     CSR                   EXSR ZZDFT2
     CSR                   ELSE
     C*
     C*  Otherwise get existing record(s).
     C*
     CSR                   MOVE *ON       *IN91
     CSR                   EXSR ZZGET2
     CSR                   EXSR ZZFIL2
     CSR                   ENDIF
     CSR         END02I    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  Screen 03 initialization
     C*
     CSR         SCR03I    BEGSR
     CSR                   MOVE '03 '     NXTSCR
     C*
     C*  Get field defaults if this is an add.
     C*
     CSR         $PCMD     IFEQ '*ADD    '
     CSR                   EXSR ZZGET3
     CSR                   EXSR ZZDFT3
     CSR                   ELSE
     C*
     C*  Otherwise get existing record(s).
     C*
     CSR                   MOVE *ON       *IN91
     CSR                   EXSR ZZGET3
     CSR                   EXSR ZZFIL3
     CSR                   ENDIF
     CSR         END03I    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  Screen 04 initialization
     C*
     CSR         SCR04I    BEGSR
     CSR                   MOVE '04 '     NXTSCR
     C*
     C*  Get field defaults if this is an add.
     C*
     CSR         $PCMD     IFEQ '*ADD    '
     CSR                   EXSR ZZGET4
     CSR                   EXSR ZZDFT4
     CSR                   ELSE
     C*
     C*  Otherwise get existing record(s).
     C*
     CSR                   MOVE *ON       *IN91
     CSR                   EXSR ZZGET4
     CSR                   EXSR ZZFIL4
     CSR                   ENDIF
     CSR         END04I    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  Screen 05 initialization
     C*
     CSR         SCR05I    BEGSR
     CSR                   MOVE '05 '     NXTSCR
     C*
     C*  Get field defaults if this is an add.
     C*
     CSR         $PCMD     IFEQ '*ADD    '
     CSR                   EXSR ZZGET5
     CSR                   EXSR ZZDFT5
     CSR                   ELSE
     C*
     C*  Otherwise get existing record(s).
     C*
     CSR                   MOVE *ON       *IN91
     CSR                   EXSR ZZGET5
     CSR                   EXSR ZZFIL5
     CSR                   ENDIF
     CSR         END05I    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  Screen 06 initialization
     C*
     CSR         SCR06I    BEGSR
     CSR                   MOVE '06 '     NXTSCR
     C*
     C*  Get field defaults if this is an add.
     C*
     CSR         $PCMD     IFEQ '*ADD    '
     CSR                   EXSR ZZGET6
     CSR                   EXSR ZZDFT6
     CSR                   ELSE
     C*
     C*  Otherwise get existing record(s).
     C*
     CSR                   MOVE *ON       *IN91
     CSR                   EXSR ZZGET6
     CSR                   EXSR ZZFIL6
     CSR                   ENDIF
     CSR         END06I    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  Screen 07 initialization
     C*
     CSR         SCR07I    BEGSR
     CSR                   MOVE '07 '     NXTSCR
     C*
     C*  Get field defaults if this is an add.
     C*
     CSR         $PCMD     IFEQ '*ADD    '
     CSR                   EXSR ZZGET7
     CSR                   EXSR ZZDFT7
     CSR                   ELSE
     C*
     C*  Otherwise get existing record(s).
     C*
     CSR                   MOVE *ON       *IN91
     CSR                   EXSR ZZGET7
     CSR                   EXSR ZZFIL7
     CSR                   ENDIF
     CSR         END07I    ENDSR
     C*----------------------------------------------------------------
     C*
     C*              Screen Processing Routines
     C*
     C*----------------------------------------------------------------
     C*
     C*  SC1  -  Screen 1
     C*
     CSR         SC1       BEGSR
     C*
     C*  Test for F3 - Exit
     C*
     CSR         *INKC     IFEQ *ON
     CSR                   MOVE 'EOJ'     NXTSCR
     CSR                   MOVE '*EXIT   '$PRTN
     CSR                   GOTO ENDSC1
     CSR                   END
     C*
     C*  Test for F12 - Previous
     C*
     CSR         *INKL     IFEQ *ON
     CSR                   MOVE 'EOJ'     NXTSCR
     CSR                   MOVE '*CANCEL '$PRTN
     CSR                   GOTO ENDSC1
     CSR                   END
     C*
     C*  Test for other command keys
     C*
     CSR                   EXSR ZZCMD1
     CSR         CMDTKN    CABEQ*ON       ENDSC1
     C*
     C*  Some other key pressed.
     C*
     C*     Check input and write/update record.
     C*
     CSR         $PCMD     IFEQ '*ADD    '
     CSR         $PCMD     OREQ '*CHANGE '
     CSR                   EXSR ZZCHK1
     CSR         ERROR     CABEQ*ON       ENDSC1
     CSR                   EXSR ZZUPD1
     CSR         ERROR     CABEQ*ON       ENDSC1
     CSR                   END
     CSR                   EXSR ZZNXT1
     C*R                   MOVE 'EOJ'     NXTSCR
     CSR         ENDSC1    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  SC2  -  Screen 2
     C*
     CSR         SC2       BEGSR
     C*
     C*  Test for F3 - Exit
     C*
     CSR         *INKC     IFEQ *ON
     CSR                   MOVE '01 '     NXTSCR
     C*R                   MOVE '*EXIT   '$PRTN
     CSR                   GOTO ENDSC2
     CSR                   END
     C*
     C*  Test for F12 - Previous
     C*
     CSR         *INKL     IFEQ *ON
     CSR                   MOVE '01 '     NXTSCR
     C*R                   MOVE '*CANCEL '$PRTN
     CSR                   GOTO ENDSC2
     CSR                   END
     C*
     C*  Test for other command keys
     C*
     CSR                   EXSR ZZCMD2
     CSR         CMDTKN    CABEQ*ON       ENDSC2
     C*
     C*  Some other key pressed.
     C*
     C*     Check input and write/update record.
     C*
     CSR         $PCMD     IFEQ '*ADD    '
     CSR         $PCMD     OREQ '*CHANGE '
     CSR                   EXSR ZZCHK2
     CSR         ERROR     CABEQ*ON       ENDSC2
     CSR                   EXSR ZZUPD2
     CSR         ERROR     CABEQ*ON       ENDSC2
     CSR                   END
     CSR                   MOVE '01 '     NXTSCR
     CSR         ENDSC2    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  SC3  -  Screen 3
     C*
     CSR         SC3       BEGSR
     C*
     C*  Test for F3 - Exit
     C*
     CSR         *INKC     IFEQ *ON
     CSR                   MOVE '01 '     NXTSCR
     C*R                   MOVE '*EXIT   '$PRTN
     CSR                   GOTO ENDSC3
     CSR                   END
     C*
     C*  Test for F12 - Previous
     C*
     CSR         *INKL     IFEQ *ON
     CSR                   MOVE '01 '     NXTSCR
     C*R                   MOVE '*CANCEL '$PRTN
     CSR                   GOTO ENDSC3
     CSR                   END
     C*
     C*  Test for other command keys
     C*
     CSR                   EXSR ZZCMD3
     CSR         CMDTKN    CABEQ*ON       ENDSC3
     C*
     C*  Some other key pressed.
     C*
     C*     Check input and write/update record.
     C*
     CSR         $PCMD     IFEQ '*ADD    '
     CSR         $PCMD     OREQ '*CHANGE '
     CSR                   EXSR ZZCHK3
     CSR         ERROR     CABEQ*ON       ENDSC3
     CSR                   EXSR ZZUPD3
     CSR         ERROR     CABEQ*ON       ENDSC3
     CSR                   END
     CSR                   MOVE '01 '     NXTSCR
     CSR         ENDSC3    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  SC4  -  Screen 4
     C*
     CSR         SC4       BEGSR
     C*
     C*  Test for F3 - Exit
     C*
     CSR         *INKC     IFEQ *ON
     CSR                   MOVE '01 '     NXTSCR
     C*R                   MOVE '*EXIT   '$PRTN
     CSR                   GOTO ENDSC4
     CSR                   END
     C*
     C*  Test for F12 - Previous
     C*
     CSR         *INKL     IFEQ *ON
     CSR                   MOVE '01 '     NXTSCR
     C*R                   MOVE '*CANCEL '$PRTN
     CSR                   GOTO ENDSC4
     CSR                   END
     C*
     C*  Test for other command keys
     C*
     CSR                   EXSR ZZCMD4
     CSR         CMDTKN    CABEQ*ON       ENDSC4
     C*
     C*  Some other key pressed.
     C*
     C*     Check input and write/update record.
     C*
     CSR         $PCMD     IFEQ '*ADD    '
     CSR         $PCMD     OREQ '*CHANGE '
     CSR                   EXSR ZZCHK4
     CSR         ERROR     CABEQ*ON       ENDSC4
     CSR                   EXSR ZZUPD4
     CSR         ERROR     CABEQ*ON       ENDSC4
     CSR                   END
     CSR                   MOVE '01 '     NXTSCR
     CSR         ENDSC4    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  SC5  -  Screen 5
     C*
     CSR         SC5       BEGSR
     C*
     C*  Test for F3 - Exit
     C*
     CSR         *INKC     IFEQ *ON
     CSR                   MOVE '01 '     NXTSCR
     C*R                   MOVE '*EXIT   '$PRTN
     CSR                   GOTO ENDSC5
     CSR                   END
     C*
     C*  Test for F12 - Previous
     C*
     CSR         *INKL     IFEQ *ON
     CSR                   MOVE '01 '     NXTSCR
     C*R                   MOVE '*CANCEL '$PRTN
     CSR                   GOTO ENDSC5
     CSR                   END
     C*
     C*  Test for other command keys
     C*
     CSR                   EXSR ZZCMD5
     CSR         CMDTKN    CABEQ*ON       ENDSC5
     C*
     C*  Some other key pressed.
     C*
     C*     Check input and write/update record.
     C*
     CSR         $PCMD     IFEQ '*ADD    '
     CSR         $PCMD     OREQ '*CHANGE '
     CSR                   EXSR ZZCHK5
     CSR         ERROR     CABEQ*ON       ENDSC5
     CSR                   EXSR ZZUPD5
     CSR         ERROR     CABEQ*ON       ENDSC5
     CSR                   END
     CSR                   MOVE '01 '     NXTSCR
     CSR         ENDSC5    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  SC6  -  Screen 6
     C*
     CSR         SC6       BEGSR
     C*
     C*  Test for F3 - Exit
     C*
     CSR         *INKC     IFEQ *ON
     CSR                   MOVE '01 '     NXTSCR
     C*R                   MOVE '*EXIT   '$PRTN
     CSR                   GOTO ENDSC6
     CSR                   END
     C*
     C*  Test for F12 - Previous
     C*
     CSR         *INKL     IFEQ *ON
     CSR                   MOVE '01 '     NXTSCR
     C*R                   MOVE '*CANCEL '$PRTN
     CSR                   GOTO ENDSC6
     CSR                   END
     C*
     C*  Test for other command keys
     C*
     CSR                   EXSR ZZCMD6
     CSR         CMDTKN    CABEQ*ON       ENDSC6
     C*
     C*  Some other key pressed.
     C*
     C*     Check input and write/update record.
     C*
     CSR         $PCMD     IFEQ '*ADD    '
     CSR         $PCMD     OREQ '*CHANGE '
     CSR                   EXSR ZZCHK6
     CSR         ERROR     CABEQ*ON       ENDSC6
     CSR                   EXSR ZZUPD6
     CSR         ERROR     CABEQ*ON       ENDSC6
     CSR                   END
     CSR                   MOVE '01 '     NXTSCR
     CSR         ENDSC6    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  SC7  -  Screen 7
     C*
     CSR         SC7       BEGSR
     C*
     C*  Test for F3 - Exit
     C*
     CSR         *INKC     IFEQ *ON
     CSR                   MOVE '01 '     NXTSCR
     C*R                   MOVE '*EXIT   '$PRTN
     CSR                   GOTO ENDSC7
     CSR                   END
     C*
     C*  Test for F12 - Previous
     C*
     CSR         *INKL     IFEQ *ON
     CSR                   MOVE '01 '     NXTSCR
     C*R                   MOVE '*CANCEL '$PRTN
     CSR                   GOTO ENDSC7
     CSR                   END
     C*
     C*  Test for other command keys
     C*
     CSR                   EXSR ZZCMD7
     CSR         CMDTKN    CABEQ*ON       ENDSC7
     C*
     C*  Some other key pressed.
     C*
     C*     Check input and write/update record.
     C*
     CSR         $PCMD     IFEQ '*ADD    '
     CSR         $PCMD     OREQ '*CHANGE '
     CSR                   EXSR ZZCHK7
     CSR         ERROR     CABEQ*ON       ENDSC7
     CSR                   EXSR ZZUPD7
     CSR         ERROR     CABEQ*ON       ENDSC7
     CSR                   END
     CSR                   MOVE '01 '     NXTSCR
     CSR         ENDSC7    ENDSR
     C*----------------------------------------------------------------
     C*
     C*          SUBROUTINES IN ALPHABETICAL ORDER
     C*
     C*----------------------------------------------------------------
     C*
     C*  *INZSR  Initialization subrotine
     C*
     CSR         *INZSR    BEGSR
     CSR                   MOVE *ON       FOREVR  1
     CSR                   MOVE *OFF      READFW  1
     CSR                   MOVE *OFF      READBK  1
     CSR                   MOVE *OFF      ONEENT  1
     C*
     C*  Initialize special keys
     C*
     C                     Z-ADD0         ENTER   50
     C                     Z-ADD2         COMAND  50
     C                     Z-ADD01122     ROLLUP  50
     C                     Z-ADD01123     ROLLDN  50
     C                     Z-ADD01124     CLEAR   50
     C                     Z-ADD01125     HELP    50
     C*
     C*   Call user added initialization routine.
     C*
     C                     EXSR ZZINZ
     C                     ENDSR
     C*---------------------------------------------------------------
     C*
     C*  SUBROUTINE ZMxxxx  Control message display subfile
     C*
     C*    ZMCPMQ  Clear program message queue.
     C*
     CSR         ZMCPMQ    BEGSR
     CSR                   MOVE '*CLEAR ' #MSGID  7
     CSR                   MOVE '*NULL  ' #MSGTP  7
     CSR                   EXSR ZMPMSG
     CSR                   ENDSR
     C*
     C*    ZMDMSG  Display message record subfile
     C*
     CSR         ZMDMSG    BEGSR
     CSR                   MOVE *ON       *IN97
     CSR                   WRITEMSGCTL
     CSR                   ENDSR
     C*
     C*    ZMPMSG  Add message record to subfile
     C*
     CSR         ZMPMSG    BEGSR
     CSR         $MSGF     IFEQ *BLANKS
     CSR                   MOVE #MSGF     $MSGF  10
     CSR                   END
     CSR                   CALL 'PUTMSG'
     CSR                   PARM           $MSGF
     CSR                   PARM           #MSGID
     CSR                   PARM           #MSGTP
     CSR                   PARM           #MSGDT
     CSR                   PARM           #PGMQ
     CSR                   PARM           #MSGK
     CSR                   MOVE *BLANKS   #MSGDT
     CSR                   MOVE *BLANKS   $MSGF
     CSR                   ENDSR
     C*
     C*    ZMSMSG  Send program message to a different program msgq
     C*
     CSR         ZMSMSG    BEGSR
     CSR         $MSGF     IFEQ *BLANKS
     CSR                   MOVE #MSGF     $MSGF  10
     CSR                   END
     CSR                   CALL 'PUTMSG'
     CSR                   PARM           $MSGF
     CSR                   PARM           #MSGID  7
     CSR                   PARM           #MSGTP  7
     CSR                   PARM           #MSGDT
     CSR                   PARM $PPRG     #PGMQ2 10
     CSR                   PARM           #MSGK   4
     CSR                   MOVE *BLANKS   #MSGDT
     CSR                   MOVE *BLANKS   $MSGF
     CSR                   ENDSR
     C*
     C*    ZSCLR   Clear screen
     C*
     CSR         ZSCLR     BEGSR
     CSR                   WRITECLRSCR
     CSR                   MOVE *ON       SCLEAR  1
     CSR                   ENDSR
     C*----------------------------------------------------------------
     C*    ZMnnnn  Build and send message nnnn to this program
     C*----------------------------------------------------------------
     C*----------------------------------------------------------------
     C*   PIR9905  Cursor not in correct position for lookup.
     C*
     CSR         ZM9905    BEGSR
     CSR                   MOVE 'PIR9905' #MSGID
     CSR                   MOVE '*DIAG  ' #MSGTP
     CSR                   MOVE *BLANKS   $MD
     CSR                   EXSR ZMPMSG
     CSR                   ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZCHK1   Screen 1 error checking.
     C*
     CSR         ZZCHK1    BEGSR
     CSR                   MOVE *OFF      ERROR
     C*
     CSR         ENDCK1    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZCHK2   Screen 2 error checking.
     C*
     CSR         ZZCHK2    BEGSR
     CSR                   MOVE *OFF      ERROR
     C*
     CSR         ENDCK2    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZCHK3   Screen 3 error checking.
     C*
     CSR         ZZCHK3    BEGSR
     CSR                   MOVE *OFF      ERROR
     C*
     CSR         ENDCK3    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZCHK4   Screen 4 error checking.
     C*
     CSR         ZZCHK4    BEGSR
     CSR                   MOVE *OFF      ERROR
     C*
     CSR         ENDCK4    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZCHK5   Screen 5 error checking.
     C*
     CSR         ZZCHK5    BEGSR
     CSR                   MOVE *OFF      ERROR
     C*
     CSR         ENDCK5    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZCHK6   Screen 6 error checking.
     C*
     CSR         ZZCHK6    BEGSR
     CSR                   MOVE *OFF      ERROR
     C*
     CSR         ENDCK6    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZCHK7   Screen 7 error checking.
     C*
     CSR         ZZCHK7    BEGSR
     CSR                   MOVE *OFF      ERROR
     C*
     CSR         ENDCK7    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZCLR2   Clear screen 2 fields when record not found.
     C*
     CSR         ZZCLR2    BEGSR
     CSR                   MOVE *BLANKS   W2EPM
     CSR                   MOVE *BLANKS   W2RF
     CSR                   MOVE *BLANKS   W2CAPC
     CSR                   MOVE *BLANKS   W2LETD
     CSR                   MOVE *BLANKS   W2ICW
     CSR                   MOVE *BLANKS   W2WRNC
     CSR                   MOVE *ZEROS    W2RG1C
     CSR                   MOVE *ZEROS    W2RG2C
     CSR                   MOVE *BLANKS   W2IMPI
     CSR                   MOVE *BLANKS   W2MPCK
     CSR                   MOVE *ZEROS    W2RCDY
     CSR                   MOVE *ZEROS    W2PKDY
     CSR         ENDCL2    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZCLR3   Clear screen 3 fields when record not found.
     C*
     CSR         ZZCLR3    BEGSR
     CSR                   MOVE *BLANKS   W3PROG
     CSR                   MOVE *ZEROS    W3UPCT
     CSR                   MOVE *ZEROS    W3PDEF
     CSR                   MOVE *ZEROS    W3PBLD
     CSR                   MOVE *ZEROS    W3PACT
     CSR                   MOVE *ZEROS    W3PASL
     CSR                   MOVE *BLANKS   W3PFRC
     CSR                   MOVE *ZEROS    W3FASL
     CSR                   MOVE *ZEROS    W3FSID
     CSR                   MOVE *ZEROS    W3FDEF
     CSR                   MOVE *ZEROS    W3FLVL
     CSR                   MOVE *BLANKS   W3PLCN
     CSR                   MOVE *BLANKS   W3APCK
     CSR         ENDCL3    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZCMD1   User defined command keys for screen 1.
     C*
     CSR         ZZCMD1    BEGSR
     CSR                   MOVE *OFF      CMDTKN
     C*
     C*  Test for F7 - Backward
     C*
     CSR         *INKG     IFEQ *ON
     CSR                   MOVE *ON       READBK
     CSR                   MOVE *ON       CMDTKN
     CSR                   EXSR ZZGET1
     CSR                   EXSR ZZFIL1
     CSR                   ENDIF
     C*
     C*  Test for F8 - Forward
     C*
     CSR         *INKH     IFEQ *ON
     CSR                   MOVE *ON       READFW
     CSR                   MOVE *ON       CMDTKN
     CSR                   EXSR ZZGET1
     CSR                   EXSR ZZFIL1
     CSR                   ENDIF
     C*
     C*  Test for F13 - System options
     C*
     CSR         *INKM     IFEQ *ON
     CSR                   MOVE *ON       CMDTKN
     CSR                   EXSR ZZGET2
     CSR                   EXSR ZZFIL2
     CSR                   MOVE '02 '     NXTSCR
     CSR                   ENDIF
     C*
     C*  Test for F14 - Receiving options
     C*
     CSR         *INKN     IFEQ *ON
     CSR                   MOVE *ON       CMDTKN
     CSR                   EXSR ZZGET3
     CSR                   EXSR ZZFIL3
     CSR                   MOVE '03 '     NXTSCR
     CSR                   ENDIF
     C*
     C*  Test for F15 - Receiving options
     C*
     CSR         *INKP     IFEQ *ON
     CSR                   MOVE *ON       CMDTKN
     CSR                   EXSR ZZGET4
     CSR                   EXSR ZZFIL4
     CSR                   MOVE '04 '     NXTSCR
     CSR                   ENDIF
     C*
     C*  Test for F16 - Receiving options
     C*
     CSR         *INKQ     IFEQ *ON
     CSR                   MOVE *ON       CMDTKN
     CSR                   EXSR ZZGET5
     CSR                   EXSR ZZFIL5
     CSR                   MOVE '05 '     NXTSCR
     CSR                   ENDIF
     C*
     C*  Test for F17 - Display subroutines.
     C*
     CSR         *INKR     IFEQ *ON
     CSR                   MOVE *ON       CMDTKN
     C*  Clear subfile.
     CSR                   MOVE *OFF      *IN01
     CSR                   MOVE *ZEROS    RECNO
     CSR                   WRITEDSPSFC6
     CSR                   MOVE *ON       *IN01
     CSR                   EXSR ZZGET6
     CSR                   EXSR ZZFIL6
     CSR                   MOVE '06 '     NXTSCR
     CSR                   ENDIF
     C*
     C*  Test for F18 - Tie/High calculations.
     C*
     CSR         *INKS     IFEQ *ON
     CSR                   MOVE *ON       CMDTKN
     C*  Clear subfile.
     CSR                   MOVE *OFF      *IN01
     CSR                   MOVE *ZEROS    RECNO
     CSR                   WRITEDSPSFC7
     CSR                   MOVE *ON       *IN01
     CSR                   EXSR ZZGET7
     CSR                   EXSR ZZFIL7
     CSR                   MOVE '07 '     NXTSCR
     CSR                   ENDIF
     C*
     C*  Test for F21 - Print
     C*
     CSR         *INKU     IFEQ *ON
     CSR                   MOVE *ON       CMDTKN
     CSR                   ENDIF
     C*
     C*  Test for F24 - More keys
     C*
     CSR         *INKY     IFEQ *ON
     CSR                   ADD  1         K
     CSR         K         IFGT 3
     CSR                   Z-ADD1         K
     CSR                   ENDIF
     CSR                   MOVE CMDLN,K   CMDLN1
     CSR                   MOVE *ON       CMDTKN
     CSR                   ENDIF
     C*
     CSR         ENDCM1    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZCMD2   User defined command keys for screen 2.
     C*
     CSR         ZZCMD2    BEGSR
     CSR         ENDCM2    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZCMD3   User defined command keys for screen 3.
     C*
     CSR         ZZCMD3    BEGSR
     CSR         ENDCM3    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZCMD4   User defined command keys for screen 4.
     C*
     CSR         ZZCMD4    BEGSR
     CSR         ENDCM4    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZCMD5   User defined command keys for screen 5.
     C*
     CSR         ZZCMD5    BEGSR
     CSR         ENDCM5    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZCMD6   User defined command keys for screen 6.
     C*
     CSR         ZZCMD6    BEGSR
     CSR         ENDCM6    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZCMD7   User defined command keys for screen 7.
     C*
     CSR         ZZCMD7    BEGSR
     CSR         ENDCM7    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZDFT1   Get default values for add.
     C*
     CSR         ZZDFT1    BEGSR
     CSR                   ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZDFT2   Get default values for add.
     C*
     CSR         ZZDFT2    BEGSR
     CSR                   ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZDFT3   Get default values for add.
     C*
     CSR         ZZDFT3    BEGSR
     CSR                   ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZDFT4   Get default values for add.
     C*
     CSR         ZZDFT4    BEGSR
     CSR                   ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZDFT5   Get default values for add.
     C*
     CSR         ZZDFT5    BEGSR
     CSR                   ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZDFT6   Get default values for add.
     C*
     CSR         ZZDFT6    BEGSR
     CSR                   ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZDFT7   Get default values for add.
     C*
     CSR         ZZDFT7    BEGSR
     CSR                   ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZFIL1   Fill screen 1 fields with info from file.
     C*
     CSR         ZZFIL1    BEGSR
     C*
     C*  Convert received date into mm/dd/yy format.
     C*
     CSR                   MOVE TRRCDT    $CVD8I
     CSR                   MOVE '*CMDMDY '$CVCMD
     CSR                   MOVE *ZEROS    $CVD6O
     CSR                   CALL @CVTDT
     CSR                   PARM           $CVTDT
     CSR                   Z-ADD$CVD6O    W1RCDT
     CSR                   Z-ADDTRRCTM    W1RCTM
     CSR                   MOVE TRUSER    W1RCBY
     CSR                   MOVE TRDEV     W1RCJB
     C*
     CSR                   Z-ADDTRWHSE    W1WHSE
     CSR         WHKEY     CHAINWAREHS               79
     CSR         *IN79     IFEQ *OFF
     CSR                   MOVE WHDESC    W1WHDS
     CSR                   ELSE
     CSR                   MOVE *BLANKS   W1WHDS
     CSR                   ENDIF
     CSR                   Z-ADDTRVEN#    W1VEN#
     CSR                   MOVE TRPO      W1PO
     CSR         PHKEY     CHAINPOHDR                79
     CSR         *IN79     IFEQ *OFF
     CSR                   MOVE PHVNAM    W1VNAM
     CSR                   ELSE
     CSR                   MOVE *BLANKS   W1VNAM
     CSR                   ENDIF
     CSR                   Z-ADD$PWHSE    W1WHSE
     CSR                   Z-ADDTRRCQ1    W1QRC1
     CSR                   Z-ADDTRRCQ2    W1QRC2
     CSR                   Z-ADDTRRCQ3    W1QRC3
     C*
     C*   Get Unit of measure fields
     C*
     CSR                   EXSR ZZUOM
     C*
     CSR                   MOVE TRDESG    W1DESG
     CSR         DSKEY     CHAINDESIG                79
     CSR         *IN79     IFEQ *ON
     CSR                   MOVE *BLANKS   W1DSDS
     CSR                   ELSE
     CSR                   MOVE DSDESC    W1DSDS
     CSR                   ENDIF
     CSR                   MOVE *BLANKS   W1DSCD
     CSR         TRDESG    IFGT *BLANKS
     CSR         TRDSCD    IFEQ 'S'
     CSR                   MOVEL'(Soft'   W1DSCD
     CSR                   ELSE
     CSR                   MOVEL'(Hard'   W1DSCD
     CSR                   ENDIF
     CSR                   MOVE ')'       W1DSCD
     CSR                   ENDIF
     C*
     CSR                   MOVE TRWHDP    W1WHDP
     CSR         WDKEY     CHAINWHDEPT               79
     CSR         *IN79     IFEQ *ON
     CSR                   MOVE *BLANKS   W1DPDS
     CSR                   ELSE
     CSR                   MOVE WDDESC    W1DPDS
     CSR                   ENDIF
     C*
     CSR                   MOVE TRSTYP    W1STYP
     CSR                   MOVE TRTYPE    W1TYPE
     C*
     CSR                   MOVE TRBLD     W1BLD
     CSR         BCKEY     CHAINBLDCODE              79
     CSR         *IN79     IFEQ *ON
     CSR                   MOVE *BLANKS   W1BLDD
     CSR                   ELSE
     CSR                   MOVE BCDESC    W1BLDD
     CSR                   ENDIF
     C*
     CSR                   MOVE TRACTV    W1ACTV
     CSR         ACKEY     CHAINACTIVITY             79
     CSR         *IN79     IFEQ *ON
     CSR                   MOVE *BLANKS   W1ACTD
     CSR                   ELSE
     CSR                   MOVE ACDESC    W1ACTD
     CSR                   ENDIF
     C*
     C*  Convert expiration date into mm/dd/yy format.
     C*
     CSR         TREXPD    IFGT *ZEROS
     CSR                   MOVE TREXPD    $CVD8I
     CSR                   MOVE '*CMDMDY '$CVCMD
     CSR                   MOVE *ZEROS    $CVD6O
     CSR                   CALL @CVTDT
     CSR                   PARM           $CVTDT
     CSR                   Z-ADD$CVD6O    W1EXPD
     CSR                   ELSE
     CSR                   MOVE *ZEROS    W1EXPD
     CSR                   ENDIF
     C*
     C*  Read *RCV010 records for item tie/high definitions.
     C*
     CSR                   MOVE *ZEROS    DEFCNT  30
     CSR         TRKY1     SETLLTR10REC
     CSR         FOREVR    DOWEQFOREVR
     CSR         TRKY1     READETR10REC                  79
     CSR                   SELEC
     CSR         *IN79     WHEQ *ON
     CSR         DEFCNT    ORGE 10
     CSR         TRSQNR    ORGT 1
     CSR                   LEAVE
     C*
     CSR                   OTHER
     CSR                   MOVELTRDATA    TR10DS
     CSR                   ADD  1         DEFCNT
     C*
     CSR                   SELEC
     CSR         DEFCNT    WHEQ 1
     CSR                   MOVE TRSDEF    W1SDF1
     CSR                   Z-ADDTRTIE     W1TIE1
     CSR                   Z-ADDTRHIGH    W1HI1
     C*
     CSR         DEFCNT    WHEQ 2
     CSR                   MOVE TRSDEF    W1SDF2
     CSR                   Z-ADDTRTIE     W1TIE2
     CSR                   Z-ADDTRHIGH    W1HI2
     C*
     CSR         DEFCNT    WHEQ 3
     CSR                   MOVE TRSDEF    W1SDF3
     CSR                   Z-ADDTRTIE     W1TIE3
     CSR                   Z-ADDTRHIGH    W1HI3
     C*
     CSR         DEFCNT    WHEQ 4
     CSR                   MOVE TRSDEF    W1SDF4
     CSR                   Z-ADDTRTIE     W1TIE4
     CSR                   Z-ADDTRHIGH    W1HI4
     C*
     CSR         DEFCNT    WHEQ 5
     CSR                   MOVE TRSDEF    W1SDF5
     CSR                   Z-ADDTRTIE     W1TIE5
     CSR                   Z-ADDTRHIGH    W1HI5
     C*
     CSR         DEFCNT    WHEQ 6
     CSR                   MOVE TRSDEF    W1SDF6
     CSR                   Z-ADDTRTIE     W1TIE6
     CSR                   Z-ADDTRHIGH    W1HI6
     C*
     CSR         DEFCNT    WHEQ 7
     CSR                   MOVE TRSDEF    W1SDF7
     CSR                   Z-ADDTRTIE     W1TIE7
     CSR                   Z-ADDTRHIGH    W1HI7
     C*
     CSR         DEFCNT    WHEQ 8
     CSR                   MOVE TRSDEF    W1SDF8
     CSR                   Z-ADDTRTIE     W1TIE8
     CSR                   Z-ADDTRHIGH    W1HI8
     C*
     CSR         DEFCNT    WHEQ 9
     CSR                   MOVE TRSDEF    W1SDF9
     CSR                   Z-ADDTRTIE     W1TIE9
     CSR                   Z-ADDTRHIGH    W1HI9
     C*
     CSR         DEFCNT    WHEQ 10
     CSR                   MOVE TRSDEF    W1SDF0
     CSR                   Z-ADDTRTIE     W1TIE0
     CSR                   Z-ADDTRHIGH    W1HI0
     C*
     CSR                   ENDSL
     CSR                   ENDSL
     CSR                   ENDDO
     C*
     CSR                   ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZFIL2   Fill screen 2 fields with info from file.
     C*
     CSR         ZZFIL2    BEGSR
     CSR         TR02DS    IFNE TRERR
     CSR                   MOVE TREPM     W2EPM
     CSR                   MOVE TRRF      W2RF
     CSR                   MOVE TRCAPC    W2CAPC
     CSR                   MOVE TRLETD    W2LETD
     CSR                   MOVE TRICW     W2ICW
     CSR                   MOVE TRWRNC    W2WRNC
     CSR                   Z-ADDTRRG1C    W2RG1C
     CSR                   Z-ADDTRRG2C    W2RG2C
     CSR                   MOVE TRIMPI    W2IMPI
     CSR                   MOVE TRMPCK    W2MPCK
     CSR                   MOVE TRRCDY    W2RCDY
     CSR                   MOVE TRPKDY    W2PKDY
     CSR                   MOVE *OFF      *IN41
     CSR                   ELSE
     CSR                   MOVE *ON       *IN41
     CSR                   EXSR ZZCLR2
     CSR                   ENDIF
     CSR                   ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZFIL3   Fill screen 3 fields with info from file.
     C*
     CSR         ZZFIL3    BEGSR
     CSR         TR03DS    IFNE TRERR
     CSR                   MOVE TRLPGM    W3PROG
     CSR                   Z-ADDTRUPCT    W3UPCT
     CSR                   Z-ADDTRPDEF    W3PDEF
     CSR                   Z-ADDTRPBLD    W3PBLD
     CSR                   Z-ADDTRPACT    W3PACT
     CSR                   Z-ADDTRPASL    W3PASL
     CSR                   MOVE TRPFRC    W3PFRC
     CSR                   Z-ADDTRFASL    W3FASL
     CSR                   Z-ADDTRFSID    W3FSID
     CSR                   Z-ADDTRFDEF    W3FDEF
     CSR                   Z-ADDTRFLVL    W3FLVL
     CSR                   MOVE TRPLCN    W3PLCN
     CSR                   MOVE TRAPCK    W3APCK
     CSR                   MOVE *OFF      *IN42
     CSR                   ELSE
     CSR                   EXSR ZZCLR3
     CSR                   MOVE *ON       *IN42
     CSR                   ENDIF
     CSR                   ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZFIL4   Fill screen 4 fields with info from file.
     C*
     CSR         ZZFIL4    BEGSR
     CSR                   MOVE TRAZ01    W4AZ01
     CSR                   MOVE TRAZ02    W4AZ02
     CSR                   MOVE TRAZ03    W4AZ03
     CSR                   MOVE TRAZ04    W4AZ04
     CSR                   MOVE TRAZ05    W4AZ05
     CSR                   MOVE TRAZ06    W4AZ06
     CSR                   MOVE TRAZ07    W4AZ07
     CSR                   MOVE TRAZ08    W4AZ08
     CSR                   MOVE TRAZ09    W4AZ09
     CSR                   MOVE TRAZ10    W4AZ10
     CSR                   MOVE TRAZ11    W4AZ11
     CSR                   MOVE TRAZ12    W4AZ12
     CSR                   MOVE TRAZ13    W4AZ13
     CSR                   MOVE TRAZ14    W4AZ14
     CSR                   MOVE TRAZ15    W4AZ15
     CSR                   MOVE TRAZ16    W4AZ16
     CSR                   MOVE TRAZ17    W4AZ17
     CSR                   MOVE TRAZ18    W4AZ18
     CSR                   MOVE TRAZ19    W4AZ19
     CSR                   MOVE TRAZ20    W4AZ20
     CSR                   MOVE TRAZ21    W4AZ21
     CSR                   MOVE TRAZ22    W4AZ22
     CSR                   MOVE TRAZ23    W4AZ23
     CSR                   MOVE TRAZ24    W4AZ24
     CSR                   MOVE TRAZ25    W4AZ25
     CSR                   MOVE TRAZ26    W4AZ26
     CSR                   MOVE TRAZ27    W4AZ27
     CSR                   MOVE TRAZ28    W4AZ28
     CSR                   MOVE TRAZ29    W4AZ29
     CSR                   MOVE TRAZ30    W4AZ30
     CSR                   MOVE TRAZ31    W4AZ31
     CSR                   MOVE TRAZ32    W4AZ32
     CSR                   MOVE TRAZ33    W4AZ33
     CSR                   MOVE TRAZ34    W4AZ34
     CSR                   MOVE TRAZ35    W4AZ35
     CSR                   MOVE TRAZ36    W4AZ36
     CSR                   MOVE TRAZ37    W4AZ37
     CSR                   MOVE TRAZ38    W4AZ38
     CSR                   MOVE TRAZ39    W4AZ39
     CSR                   MOVE TRAZ40    W4AZ40
     CSR                   MOVE TRAZ41    W4AZ41
     CSR                   MOVE TRAZ42    W4AZ42
     CSR                   MOVE TRAZ43    W4AZ43
     CSR                   MOVE TRAZ44    W4AZ44
     CSR                   MOVE TRAZ45    W4AZ45
     CSR                   MOVE TRAZ46    W4AZ46
     CSR                   MOVE TRAZ47    W4AZ47
     CSR                   MOVE TRAZ48    W4AZ48
     CSR                   MOVE TRAZ49    W4AZ49
     CSR                   MOVE TRAZ50    W4AZ50
     C*
     C*       If no activity zones defined - display msg.
     C*
     CSR         TR20DS    IFEQ *BLANKS
     CSR                   MOVE *ON       *IN46
     CSR                   ELSE
     CSR                   MOVE *OFF      *IN46
     CSR                   ENDIF
     CSR                   ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZFIL5   Fill screen 5 fields with info from file.
     C*
     CSR         ZZFIL5    BEGSR
     CSR                   MOVE TRBC01    W5BC01
     CSR                   MOVE TRBC02    W5BC02
     CSR                   MOVE TRBC03    W5BC03
     CSR                   MOVE TRBC04    W5BC04
     CSR                   MOVE TRBC05    W5BC05
     CSR                   MOVE TRBC06    W5BC06
     CSR                   MOVE TRBC07    W5BC07
     CSR                   MOVE TRBC08    W5BC08
     CSR                   MOVE TRBC09    W5BC09
     CSR                   MOVE TRBC10    W5BC10
     CSR                   MOVE TRBC11    W5BC11
     CSR                   MOVE TRBC12    W5BC12
     CSR                   MOVE TRBC13    W5BC13
     CSR                   MOVE TRBC14    W5BC14
     CSR                   MOVE TRBC15    W5BC15
     CSR                   MOVE TRBC16    W5BC16
     CSR                   MOVE TRBC17    W5BC17
     CSR                   MOVE TRBC18    W5BC18
     CSR                   MOVE TRBC19    W5BC19
     CSR                   MOVE TRBC20    W5BC20
     CSR                   MOVE TRBC21    W5BC21
     CSR                   MOVE TRBC22    W5BC22
     CSR                   MOVE TRBC23    W5BC23
     CSR                   MOVE TRBC24    W5BC24
     CSR                   MOVE TRBC25    W5BC25
     CSR                   MOVE TRBC26    W5BC26
     CSR                   MOVE TRBC27    W5BC27
     CSR                   MOVE TRBC28    W5BC28
     CSR                   MOVE TRBC29    W5BC29
     CSR                   MOVE TRBC30    W5BC30
     CSR                   MOVE TRBC31    W5BC31
     CSR                   MOVE TRBC32    W5BC32
     CSR                   MOVE TRBC33    W5BC33
     CSR                   MOVE TRBC34    W5BC34
     CSR                   MOVE TRBC35    W5BC35
     CSR                   MOVE TRBC36    W5BC36
     CSR                   MOVE TRBC37    W5BC37
     CSR                   MOVE TRBC38    W5BC38
     CSR                   MOVE TRBC39    W5BC39
     CSR                   MOVE TRBC40    W5BC40
     CSR                   MOVE TRBC41    W5BC41
     CSR                   MOVE TRBC42    W5BC42
     CSR                   MOVE TRBC43    W5BC43
     CSR                   MOVE TRBC44    W5BC44
     CSR                   MOVE TRBC45    W5BC45
     CSR                   MOVE TRBC46    W5BC46
     CSR                   MOVE TRBC47    W5BC47
     CSR                   MOVE TRBC48    W5BC48
     CSR                   MOVE TRBC49    W5BC49
     CSR                   MOVE TRBC50    W5BC50
     C*
     C*       If no build codes defined - display msg.
     C*
     CSR         TR30DS    IFEQ *BLANKS
     CSR                   MOVE *ON       *IN47
     CSR                   ELSE
     CSR                   MOVE *OFF      *IN47
     CSR                   ENDIF
     CSR                   ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZFIL6   Fill screen 6 fields with info from file.
     C*
     CSR         ZZFIL6    BEGSR
     CSR                   MOVE *ZEROS    Y
     CSR                   MOVE *BLANKS   SFLDS
     CSR         FOREVR    DOWEQFOREVR
     CSR         TRKY4     READETR40REC                  79
     CSR                   SELEC
     CSR         *IN79     WHEQ *ON
     CSR         Y         IFGT *ZEROS
     CSR                   ADD  1         RECNO
     CSR                   WRITEDSPSFL6                50
     CSR                   MOVE *BLANKS   SFLDS
     CSR                   MOVE *ZEROS    Y
     CSR                   ENDIF
     CSR                   LEAVE                           Exit loop
     C*
     CSR                   OTHER
     CSR                   MOVELTRDATA    TR40DS
     C*
     CSR         1         DO   25        X
     CSR                   ADD  1         Y
     CSR                   MOVE TRR,X     SRCD,Y
     CSR         Y         IFEQ 11
     CSR                   ADD  1         RECNO
     CSR                   WRITEDSPSFL6                50
     CSR                   MOVE *BLANKS   SFLDS
     CSR                   MOVE *ZEROS    Y
     CSR                   ENDIF
     CSR                   ENDDO
     C*
     CSR                   ENDSL
     CSR                   ENDDO
     C*
     CSR                   ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZFIL7   Fill screen 6 fields with info from file.
     C*
     CSR         ZZFIL7    BEGSR
     CSR         FOREVR    DOWEQFOREVR
     CSR         TRKY4     READETR11REC                  79
     CSR                   SELEC
     CSR         *IN79     WHEQ *ON
     CSR         RECNO     IFEQ *ZEROS
     CSR                   MOVE *ON       *IN56
     CSR                   ELSE
     CSR                   MOVE *OFF      *IN56
     CSR                   ENDIF
     CSR                   LEAVE                           Exit loop
     C*
     CSR                   OTHER
     CSR                   MOVELTRDATA    TR11DS
     C*
     CSR         TRKY5     SETLLTR10REC
     CSR         1         DO   TRLDEF    X
     CSR         TRKY5     READETR10REC                  79
     C*
     CSR         *IN79     IFEQ *OFF
     CSR                   MOVELTRDATA    TR10DS
     CSR         X         OCUR DEFS
     CSR                   MOVELTR10DS    DEFS
     CSR                   ENDIF
     CSR                   ENDDO
     C*
     C*
     CSR         1         DO   TRLDEF    X
     CSR                   MOVE OCR,X     SAVDS
     CSR         SVOCUR    OCUR DEFS
     CSR                   MOVE DSSDEF    W7SDEF
     CSR                   MOVE DSTIE     W7TIE
     CSR                   MOVE DSHIGH    W7HIGH
     CSR                   MOVE DSPQTY    W7PQTY
     CSR                   MOVE DSPOS     W7POS
     CSR                   MOVE DSPOSF    W7POSF
     CSR                   MOVE DSPLTS    W7PLTS
     CSR                   MOVE DSSLTS    W7SLTS
     CSR                   MOVE DSSQTY    W7SQTY
     CSR                   MOVE DSPCTU    W7PCTU
     CSR         W7PCTU    IFEQ *ZEROS
     CSR                   Z-ADD100.00    W7PCTU
     CSR                   ELSE
     CSR         DSPCTU    MULT 100.00    W7PCTU
     CSR                   ENDIF
     CSR                   MOVE DSTQTY    W7TQTY
     C*
     C*    Load line 2 of subfile.
     C*
     CSR                   MOVE SVFLAG    W7SRTS
     CSR                   MOVE SVOCUR    W7OCUR
     CSR                   Z-ADDTRSQNR    W7SQNR
     CSR         SVPCTE    MULT 100.00    W7PCTE
     C*
     CSR                   ADD  1         RECNO
     CSR                   WRITEDSPSFL7                50
     CSR                   ENDDO
     C*
     C*    Reposition record pointer for next read.
     C*
     CSR         TRKY5     SETGTTR11REC
     CSR                   ENDSL
     CSR                   ENDDO
     C*
     CSR                   ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZGET1   Get record(s) for screen 1.
     C*
     CSR         ZZGET1    BEGSR
     C*
     C*   Get record from main file.
     C*
     C*   Note:  The following code for the read forward and read
     C*          backward appear to be reversed. It is because the
     C*          file is keyed in descending order on date/time.
     C*
     CSR                   SELEC
     CSR         READFW    WHEQ *ON
     CSR                   MOVE *OFF      READFW
     CSR         TRKY1     SETLLTR01REC
     CSR         TRKY2     REDPETR01REC                  79
     C*
     CSR         READBK    WHEQ *ON
     CSR                   MOVE *OFF      READBK
     CSR         TRKY1     SETGTTR01REC
     CSR         TRKY2     READETR01REC                  79
     C*
     CSR         ONEENT    WHEQ *ON
     CSR                   MOVE *OFF      ONEENT
     CSR         TRKY3     SETLLTR01REC
     CSR         TRKY3     READETR01REC                  79
     C*
     CSR                   OTHER
     CSR         TRKY2     SETLLTR01REC
     CSR         TRKY2     READETR01REC                  79
     CSR                   ENDSL
     C*
     C*  Record not found.
     C*
     CSR         *IN79     IFEQ *ON
     CSR                   ELSE
     CSR                   MOVELTRDATA    TR01DS
     CSR                   END
     C*
     C*   If viewing, release record.
     C*
     CSR         $PCMD     IFEQ '*VIEW   '
     CSR                   END
     CSR         ENDGT1    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZGET2   Get record(s) for screen 2.
     C*
     CSR         ZZGET2    BEGSR
     CSR         TRKY4     SETLLTR02REC
     CSR         TRKY4     READETR02REC                  79
     C*
     C*  Record not found.
     C*
     CSR         *IN79     IFEQ *ON
     CSR                   MOVELTRERR     TR02DS    P
     CSR                   ELSE
     CSR                   MOVELTRDATA    TR02DS
     CSR                   ENDIF
     C*
     CSR         ENDGT2    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZGET3   Get record(s) for screen 3.
     C*
     CSR         ZZGET3    BEGSR
     CSR         TRKY4     SETLLTR03REC
     CSR         TRKY4     READETR03REC                  79
     C*
     C*  Record not found.
     C*
     CSR         *IN79     IFEQ *ON
     CSR                   MOVELTRERR     TR03DS    P
     CSR                   ELSE
     CSR                   MOVELTRDATA    TR03DS
     CSR                   END
     C*
     CSR         ENDGT3    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZGET4   Get record(s) for screen 4.
     C*
     CSR         ZZGET4    BEGSR
     CSR         TRKY4     SETLLTR20REC
     CSR         TRKY4     READETR20REC                  79
     C*
     C*  Record not found.
     C*
     CSR         *IN79     IFEQ *ON
     CSR                   ELSE
     CSR                   MOVELTRDATA    TR20DS
     CSR                   END
     C*
     CSR         ENDGT4    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZGET5   Get record(s) for screen 5.
     C*
     CSR         ZZGET5    BEGSR
     CSR         TRKY4     SETLLTR30REC
     CSR         TRKY4     READETR30REC                  79
     C*
     C*  Record not found.
     C*
     CSR         *IN79     IFEQ *ON
     CSR                   ELSE
     CSR                   MOVELTRDATA    TR30DS
     CSR                   END
     C*
     CSR         ENDGT5    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZGET6   Get record(s) for screen 6.
     C*
     CSR         ZZGET6    BEGSR
     CSR         TRKY4     SETLLTR40REC
     C*
     CSR         ENDGT6    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZGET7   Get record(s) for screen 6.
     C*
     CSR         ZZGET7    BEGSR
     CSR         TRKY4     SETLLTR11REC
     C*
     CSR         ENDGT7    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZINZ    Extra program initialization. Called from *INZSR.
     C*
     CSR         ZZINZ     BEGSR
     C*
     C*  Define partial key for main file.
     C*
     CSR         TRKY1     KLIST
     CSR                   KFLD           $PWHSE
     CSR                   KFLD           $PPO
     CSR                   KFLD           $PITEM
     CSR                   KFLD           TRRCDT
     CSR                   KFLD           TRRCTM
     C*
     C*  Define partial key for main file.
     C*
     CSR         TRKY2     KLIST
     CSR                   KFLD           $PWHSE
     CSR                   KFLD           $PPO
     CSR                   KFLD           $PITEM
     C*
     C*  Define partial key for main file.
     C*
     CSR         TRKY3     KLIST
     CSR                   KFLD           $PWHSE
     CSR                   KFLD           $PPO
     CSR                   KFLD           $PITEM
     CSR                   KFLD           $PRCDT
     CSR                   KFLD           $PRCTM
     CSR                   KFLD           $PDEV
     CSR                   KFLD           $PUSER
     C*
     C*  Define full key for main file.
     C*
     CSR         TRKY4     KLIST
     CSR                   KFLD           $PWHSE
     CSR                   KFLD           $PPO
     CSR                   KFLD           $PITEM
     CSR                   KFLD           TRRCDT
     CSR                   KFLD           TRRCTM
     CSR                   KFLD           TRDEV
     CSR                   KFLD           TRUSER
     CSR         TRKY5     KLIST
     CSR                   KFLD           $PWHSE
     CSR                   KFLD           $PPO
     CSR                   KFLD           $PITEM
     CSR                   KFLD           TRRCDT
     CSR                   KFLD           TRRCTM
     CSR                   KFLD           TRDEV
     CSR                   KFLD           TRUSER
     CSR                   KFLD           TRSQNR
     C*
     C*  Define key for ACTIVITY file.
     C*
     CSR         ACKEY     KLIST
     CSR                   KFLD           TRACTV
     C*
     C*  Define key for BLDCODE file.
     C*
     CSR         BCKEY     KLIST
     CSR                   KFLD           TRBLD
     C*
     C*  Define key for DESIG file.
     C*
     CSR         DSKEY     KLIST
     CSR                   KFLD           TRDESG
     C*
     C*  Define key for PIRITEM file.
     C*
     CSR         ITTKEY    KLIST
     CSR                   KFLD           $PWHSE
     CSR                   KFLD           $PITEM
     C*
     C*  Define key for POHDR file.
     C*
     CSR         PHKEY     KLIST
     CSR                   KFLD           $PWHSE
     CSR                   KFLD           $PPO
     C*
     C*  Define key for WAREHS file.
     C*
     CSR         WHKEY     KLIST
     CSR                   KFLD           $PWHSE
     C*
     C*  Define key for WHDEPT file.
     C*
     CSR         WDKEY     KLIST
     CSR                   KFLD           $PWHSE
     CSR                   KFLD           TRWHDP
     C*
     C*  Convert today's date into century format.
     C*
     CSR                   MOVE '*CURCMD '$CVCMD
     CSR                   CALL @CVTDT
     CSR                   PARM           $CVTDT
     CSR                   Z-ADD$CVD8O    TODAY   80
     C*
     C*  Setup command display lines.
     C*
     CSR                   Z-ADD1         K       30
     CSR                   MOVE CMDLN,K   CMDLN1
     CSR                   MOVE CMDLN,4   CMDLN6
     CSR                   MOVE CMDLN,5   CMDLN7
     C*
     CSR                   MOVE *ZEROS    RECNO   50
     CSR                   MOVE *ZEROS    X       30
     CSR                   MOVE *ZEROS    Y       30
     C*
     CSR                   MOVE #PROG     $CVPRG
     CSR                   MOVE #PROG     #PGMQ
     CSR                   ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZINZ2   Program initialization. Called from main line.
     C*
     CSR         ZZINZ2    BEGSR
     C*
     CSR         $PCMD     IFEQ '*VIEW   '
     CSR         $PCMD     OREQ '*VIEW2  '
     CSR         $PCMD     IFEQ '*VIEW2  '
     CSR                   MOVE *ON       ONEENT
     CSR                   ENDIF
     CSR                   EXSR SCR01I
     CSR                   ENDIF
     C*
     CSR         $PCMD     IFEQ '*VIEW   '
     C*R                   EXSR SCR02I
     CSR                   ENDIF
     CSR         ENDINZ    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZNXT1   What to do next when screen 1 input is ok.
     C*
     CSR         ZZNXT1    BEGSR
     CSR                   Z-ADD$PWHSE    $LWHSE
     CSR                   MOVE $PPO      $LPO
     CSR                   MOVE $PITEM    $LITEM
     CSR                   Z-ADDTRRCDT    $LRCDT
     CSR                   Z-ADDTRRCTM    $LRCTM
     C*
     CSR                   CALL 'PO134'
     CSR                   PARM           $LPARM
     CSR                   PARM TRDEV     $LDEV  10
     CSR                   PARM TRUSER    $LUSER 10
     CSR                   PARM *BLANKS   $PRTCD  8
     CSR         ENDNXT    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZUOM    Get Unit Of Measure Normal, Breakdown1, Breakdown2.
     C*
     CSR         ZZUOM     BEGSR
     C*
     C*   Get Unit of Measures.
     C*    *IN94=Non-display breakdown1 unit of measure
     C*    *IN93=Non-display breakdown2 unit of measure
     C*
     CSR                   MOVE *OFF      *IN94
     CSR                   MOVE *OFF      *IN93
     CSR                   MOVE *BLANKS   WOITEM
     CSR                   MOVE *BLANKS   W1UM1
     CSR                   MOVE *BLANKS   W1UM2
     CSR                   MOVE *BLANKS   W1UM3
     CSR         ITTKEY    CHAINPIRITEM              75
     CSR         *IN75     IFEQ *ON
     CSR                   MOVE *ON       *IN94
     CSR                   MOVE *ON       *IN93
     CSR                   MOVELTRITEM    WOITEM    P
     CSR                   GOTO ENDUOM
     CSR                   ELSE
     CSR         ITFLG1    IFEQ 'N'
     CSR                   MOVE *ON       *IN94
     CSR                   ENDIF
     CSR         ITFLG2    IFEQ 'N'
     CSR                   MOVE *ON       *IN93
     CSR                   ENDIF
     C*
     CSR                   MOVELTRITEM    $IITEM
     CSR                   MOVELITDESC    $IDESC
     CSR                   MOVELITPDSC    $IPDSC
     CSR                   MOVE *BLANKS   $ISTR
     CSR                   CALL @FMTIT
     CSR                   PARM           $IITEM 15
     CSR                   PARM           $IDESC 30
     CSR                   PARM           $IPDSC 15
     CSR                   PARM           $ISTR  70
     CSR                   MOVEL$ISTR     WOITEM
     CSR                   ENDIF
     C*
     CSR         ITUM1     CHAINUNMESR               75
     CSR         *IN75     IFEQ *OFF
     CSR                   MOVE UMSHRT    W1UM1
     CSR                   ELSE
     CSR                   MOVELITUM1     W1UM1     P
     CSR                   ENDIF
     C*
     CSR         *IN94     IFEQ *OFF
     CSR         ITUM2     CHAINUNMESR               75
     CSR         *IN75     IFEQ *OFF
     CSR                   MOVE UMSHRT    W1UM2
     CSR                   ELSE
     CSR                   MOVELITUM2     W1UM2     P
     CSR                   ENDIF
     CSR                   ENDIF
     C*
     CSR         *IN93     IFEQ *OFF
     CSR         ITUM3     CHAINUNMESR               75
     CSR         *IN75     IFEQ *OFF
     CSR                   MOVE UMSHRT    W1UM3
     CSR                   ELSE
     CSR                   MOVELITUM3     W1UM3     P
     CSR                   ENDIF
     CSR                   ENDIF
     CSR         ENDUOM    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZUPD1   Update record.
     C*
     CSR         ZZUPD1    BEGSR
     CSR                   MOVE *OFF      ERROR
     CSR         ENDUP1    ENDSR
     C*
     C*----------------------------------------------------------------
     C*
     C*  ZZUPD2   Update record.
     C*
     CSR         ZZUPD2    BEGSR
     CSR                   MOVE *OFF      ERROR
     CSR         ENDUP2    ENDSR
     C*
     C*----------------------------------------------------------------
     C*
     C*  ZZUPD3   Update record.
     C*
     CSR         ZZUPD3    BEGSR
     CSR                   MOVE *OFF      ERROR
     CSR         ENDUP3    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZUPD4   Update record.
     C*
     CSR         ZZUPD4    BEGSR
     CSR                   MOVE *OFF      ERROR
     CSR         ENDUP4    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZUPD5   Update record.
     C*
     CSR         ZZUPD5    BEGSR
     CSR                   MOVE *OFF      ERROR
     CSR         ENDUP5    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZUPD6   Update record.
     C*
     CSR         ZZUPD6    BEGSR
     CSR                   MOVE *OFF      ERROR
     CSR         ENDUP6    ENDSR
     C*----------------------------------------------------------------
     C*
     C*  ZZUPD7   Update record.
     C*
     CSR         ZZUPD7    BEGSR
     CSR                   MOVE *OFF      ERROR
     CSR         ENDUP7    ENDSR
     C*
     O*----------------------------------------------------------------*********
     O*
     O*  COMPILE TIME TABLES
     O*
**  CMDLN - Command display line
F3=Exit  F7=Backward  F8=Forward  F13=System opts  Enter=View log F24=More keys
F14=Rcv options  F15=Activity zones  F16=Build codes  F12=Cancel  F24=More keys
F17=Subroutines  F18=Tie/Hi calc  F12=Cancel                      F24=More keys
F3=Exit  F12=Cancel
F3=Exit  F11=Fold  F12=Cancel
